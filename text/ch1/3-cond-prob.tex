\section{条件概率}

\begin{definition}
    设$P(A)>0$，称
    \begin{align*}
        P(B|A):=\frac{P(AB)}{P(A)}
    \end{align*}
    为在\textbf{事件$A$发生条件下，事件$B$的条件概率}．
\end{definition}

比如, 在古典概率模型中，
\begin{align*}
    P(B|A)=\frac{\mbox{事件$AB$包含的样本点数}}{\mbox{事件$A$包含的样本点数}}=\frac{n(AB)}{n(A)}.
\end{align*}

条件概率也是概率, 因此它也具有概率的性质: 

\begin{proposition}
    设$P(A)>0$，则
    \begin{itemize}
        \item 对任意事件$B$，均有$P(B|A)\ge 0$；
        \item $P(\Omega|A)=1$；
        \item 若事件序列$\{B_n\}_{n\ge 1}$两两互斥，则
              $$P\left( \left. \bigcup_{n=1}^{\infty} B_n \right| A\right)=\sum_{n=1}^{\infty} P(B_n|A)$$
    \end{itemize}
\end{proposition}

由于条件概率, 我们有概率的乘法公式: 

\begin{theorem}[乘法公式]
    由条件概率的定义，得到
    \begin{itemize}
        \item 如果$P(A)>0$，则有$P(AB)=P(A)P(B|A)$．
        \item 如果$P(B)>0$，则有$P(AB)=P(B)P(A|B)$．
    \end{itemize}
\end{theorem}

我们同样可以把这个性质推广到$n$个物品的时候. 

\begin{corollary}
    如果$P(A_1 A_2\cdots A_{n-1})>0$，则有\textbf{乘法公式}
    \begin{align*}
          & P(A_1A_2\cdots A_n)                                                \\
        = & P(A_1)P(A_2|A_1)P(A_3|A_1 A_2)\cdots P(A_n|A_1 A_2\cdots A_{n-1}).
    \end{align*}
\end{corollary}

我们希望把样本空间分类讨论. 

\begin{definition}
    设$\Omega$为某试验的样本空间，$A_1, A_2, \cdots, A_n$为一组事件．如果以下条件成立：
    \begin{itemize}
        \item $A_1, A_2, \cdots, A_n$两两互斥，
        \item $A_1 \cup A_2 \cup \cdots \cup A_n=\Omega$，
    \end{itemize}
    则称$A_1, A_2, \cdots , A_n$为样本空间$\Omega$的一个\textbf{划分}．
    %或称$A_1, A_2, \cdots, A_n$为一个完备事件组．
\end{definition}

有了这样的分类之后, 我们就可以给出全概率了. 

\begin{theorem}[全概率公式]
    如果$A_1, A_2, \cdots, A_n$ 是样本空间的划分，且都有正概率，则对任意事件$B$有
    \begin{align*}
        P(B)=\sum_{i=1}^n P(A_i) P(B|A_i).
    \end{align*}
\end{theorem}

\begin{example}
    假设要对研究生论文抄袭现象进行社会调查，我们设计两个具有\textbf{相同答案}的问题：
        \begin{itemize}
            \item 你的生日是否在7月1日以前？
            \item 你做论文时是否有过抄袭行为？
        \end{itemize}
        同时提供给受访者一个放有等量红球和白球的袋子，
        受访者在不被观察的情况下从袋子中随机取一个球观察颜色后放回．
        如果是红球回答第一个问题，白球回答第二个问题．

        假定受访者有150人，统计出共有60个回答“是”．问：有抄袭行为的比率是多少？
\end{example}

\begin{solution}
    事件$A$表示抽到白球，事件$B$表示回答是，则有
    $$P(B)=P(A)P(B|A)+P(\overline{A})P(B|\overline{A}).$$
    代入已知的概率，得到
    $$\frac{60}{150}=\frac12\cdot P(B|A)+\frac12\cdot\frac12 $$
    求得
    $$P(B|A)=\frac{3}{10}$$
\end{solution}

有时候我们希望把上面的和下面的反过来. 

\begin{theorem}
    设$0<P(A)<1$，$P(B)>0$，则有
    $$P(A|B)=\frac{P(AB)}{P(B)}
        =\frac{P(A)P(B|A)}{P(A)P(B|A)+P(\overline{A})P(B|\overline{A})}$$
\end{theorem}

同样的我们有推论: 

\begin{corollary}
    如果$A_1, A_2, \cdots A_n$ 是样本空间的一个划分，且都有正概率，则对任意正概率的事件$B$有
    \[
        P(A_i|B)=\frac{P(A_i)P(B|A_i)}{P(A_1)P(B|A_1)+\cdots+P(A_n)P(B|A_n)}.%,\ i=1,\cdots,n
    \]
\end{corollary}