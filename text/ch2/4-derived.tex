\section{随机变量的函数的分布}

在物理实验中, 我们希望测量直径$d$, 从而得到圆的面积$S={1\over4} \pi d^2$. 
但是测量是有误差的. 这时候我们发现, 随机变量$S$是随机变量$d$的函数. 记得
随机变量是定义在样本空间上的函数; 而这样的一个样本空间上面的函数又可以定义
另一个函数. 这就是我们做抽象的好处. 

更一般地, 我们希望找到如下问题的一类解法: 
\begin{itemize}
    \item 已知的随机变量 $X$ 的概率分布
    \item 去求得它的函数 $Y=g(X)$ ($g$连续, 且已知)
\end{itemize}

首先来看一个离散情形下的例子. 这里我们主要演示这件事情主要在做什么事情. 

\begin{example}
  设随机变量 $X$ 具有以下的分布律, 试求 $Y=(X-1)^2$ 的分布律.
  $$
\begin{array}{c|cccc}
X & -1 & 0 & 1 & 2 \\
\hline p_k & 0.2 & 0.3 & 0.1 & 0.4
\end{array}
$$
\end{example}

\begin{solution}
  $Y$ 所有可能取的值为 $0,1,4$. 由
$$
\begin{aligned}
& P\{Y=0\}=P\left\{(X-1)^2=0\right\}=P\{X=1\}=0.1, \\
& P\{Y=1\}=P\{X=0\}+P\{X=2\}=0.7, \\
& P\{Y=4\}=P\{X=-1\}=0.2,
\end{aligned}
$$
所以$Y$的分布律为: 
$$
\begin{aligned}
&\begin{array}{c|ccc}
Y & 0 & 1 & 4 \\
\hline p_k & 0.1 & 0.7 & 0.2
\end{array}
\end{aligned}
$$
\end{solution}

再一个简单的例子, 有别于离散的情况可以一个点一个点的考虑, 我们可以使用分布函数
这样的累计量来求积分得到.  

\begin{example}
  设随机变量为 $X$ $\sim$ $N (0, 1)$, 求$Y = e^{X}$的概率密度函数. 
  ($N(0,1)$意味着$X\sim \frac1{\sqrt{2\pi}}e^{-x^2/2}$)
\end{example}
\begin{solution}
  当$y \leq 0$时,
  \[F_Y(y) = P\{Y \leq y\} = 0\]
  \quad 故,
  \[f_Y(y) = 0\]
  
  
  \quad 当$y > 0$时,
  \[F_Y(y) = P\{Y \leq y\} = P\{ e^{X} \leq y\} = P\{X \leq \ln^{y}\}= F_X(\ln^{y})\]
  
  \quad 对两端对$x$求导, 得到
  \[f_Y(y) = f_X(\ln^{y})(\ln^{y})' = \frac{1}{y}\frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}(\ln^y)^2}\]

\end{solution}

我们发现在这种情形下, 有我们可以用如下的步骤清楚地表述我们所做的事情: 

\begin{theorem}[两个随机变量的联系(关系是严格单调函数)]
  设随机变量X具有概率密度$f_X(x),-\infty < x < \infty$,又设函数g(x)处处可导且恒有$g'(x)>0$(或恒有$g'(x)<0$),则$Y = g(X)$是连续型随机变量, 其概率密度为
  \begin{equation*}
      f_Y(y)=
      \begin{cases}
          \displaystyle f_X[h(x)]\mid h'(x)\mid,\,\, &\alpha<y<\beta,\\
          \displaystyle 0,\,\, &\text{其他},
      \end{cases}
  \end{equation*}
  其中$\alpha = \min\{g(-\infty),g(+\infty)\},\beta = \max\{g(-\infty),g(+\infty)\}$,$h(y)$是$g(x)$的反函数.
\end{theorem}

\begin{proof}
  我们只证$g'(x)>0$的情况, 此时$g(x)$在$(-\infty,\infty)$内严格单调增加, 它的反函数$h(y)$存在, 且在$(\alpha,\beta)$内严格单调增加、可导.
    
分别记X,Y的分布函数为$F_X(x),F_Y(y)$.现在先来求$Y$的分布函数$F_Y(y)$.
 
因为$Y = g(X)$在$(\alpha,\beta)$内取值, 故当$y \leq \alpha$时, $F_Y(y) = P\{Y \leq y\} = 0$;当$y \geq \beta$时, $F_Y(y) = P\{Y \leq y\} = 1$.
 
 当$\alpha < y < \beta$时, 
 $$
 \begin{aligned}
     \small F_Y(y) &= P\{Y \leq y\} = P\{g(X) \leq y\}\\
     \small &= P\{X \leq h(y)\} = F_X[h(y)]
 \end{aligned}
$$
将$F_Y(y)$关于$y$求导数, 即得$Y$的概率密度.

\begin{align}
  f_Y(y) =
  \begin{cases}
      \displaystyle f_X[h(y)]h'(y),\,\,  &\alpha < y < \beta,\\
      \displaystyle 0,\,\,  &\text{其他}.
  \end{cases}
\end{align}
对于$g'(x)<0$的情况可以同样地证明, 此时有
\begin{align}
  \begin{cases}
      f_Y(y)=
      \displaystyle f_X[h(y)][-h'(y)],\,\, &\alpha < y < \beta,\\
      \displaystyle 0,\,\, &\text{其他}.
  \end{cases}
\end{align}
合并(1)(2)式可证定理成立.
\end{proof}

那么, 在不单调的情况下, 我们应该怎么办呢? 实际上, 我们应该分类讨论, 一个一个的来看. 如下
所示. 

\begin{example}
  设随机变量为 $X$ $\sim$ $N (0, 1)$,$Y = 2X^2+1$的概率密度函数.
\end{example}

\begin{solution}
  当$y < 1$时,
    \[ F_Y(y) = P\{Y \leq y \} = 0,f_Y(y) = 0\]

    \quad 当$y \geq 1$时, 
    \begin{align*}
    F_Y(y) & =  P\{Y \leq y\}=P\left\{2 X^2+1 \leq y\right\} \\
    & =P\left\{-\sqrt{\frac{y-1}{2}} \leq X\right.  \left.\leq \sqrt{\frac{y-1}{2}}\right\}\\
    &=\Phi\left(\sqrt{\frac{y-1}{2}}\right)-\Phi\left(-\sqrt{\frac{y-1}{2}}\right) \\
    & =2 \Phi\left(\sqrt{\frac{y-1}{2}}\right)-1\\
    f_Y(y) &= \frac{\mathrm{d}[2\Phi(\sqrt{\frac{y-1}{2}}) - 1]}{\mathrm{d}y} = \frac{1}{2\sqrt{\pi(y-1)}}e^{\frac{-(y-1)}{4}}
    \end{align*}
\end{solution}

\begin{example}
  设随机变量 $X$ 在区间 $(0,1)$ 上服从均匀分布, 求 $Y=\frac{1}{1+X}$ 的概率密度.
\end{example}
\begin{solution}
  $$
\begin{aligned}
F_Y(y) & =P\{Y \leq y\}=P\left\{\frac{1}{X+1} \leq y\right\} \\
& =P\left\{X \geq \frac{1-y}{y}\right\}=1-P\left\{X \leq \frac{1-y}{y}\right\} \\
& =1-F_X\left(\frac{1-y}{y}\right)
\end{aligned}
$$

对上式两边求导得:
$$
f_Y(y)=-f_X\left(\frac{1-y}{y}\right)\left(\frac{1-y}{y}\right)^{\prime}= \begin{cases}\frac{1}{y^2}, & \frac{1}{2}<y<1, \\ 0, & \text { 其他 }\end{cases}
$$
\end{solution}
