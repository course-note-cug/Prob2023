\section{边缘分布}

我们可以用多种角度来看二维随机变量及其分布函数: 
\begin{itemize}
  \item 作为整体: $F(x, y)$, 其中$X,Y$都是随机变量.
  \item 关注局部: $X$ 和 $Y$ 也有他们自己的分布函数. 记为 $F_X(x), F_Y(y)$.
\end{itemize}

我们``选择性地''忽略一个变量, 就得到了如下的定义:
\begin{definition}[边缘分布]
  \label{def:marginaldist}
  二维随机变量 $(X, Y)$ 作为一个整体, 具有分布函数 $F(x, y)$. 而 $X$ 和 $Y$ 都是随机变量, 各自也有分布函数, 将它们分别记为 $F_X(x), F_Y(y)$, 依次称为二维随机变量 $(X, Y)$ 关于 $X$ 和关于 $Y$ 的\emph{边缘分布函数}. 边缘分布函数可以由 $(X, Y)$ 的分布函数 $F(x, y)$ 所确定, 并且$F_X(x)=P\{X \leqslant x\}=P\{X \leqslant x, Y<\infty\}=F(x, \infty)$.
\end{definition}

\subsection{离散情形的边缘分布}
根据\cref{def:marginaldist}和离散型变量的特点, 我们可以考虑离散状态下二维随机变量的边缘分布: 

假设有二维离散型随机变量 $(X, Y)$ ,其所有可能取的值为 $\left(x_i, y_j\right), i, j=1,2, \cdots$, 记 $P\left\{X=x_i, Y=y_j\right\}=p_{i j}$. 
\begin{definition*}
  考察$X$的边缘分布:
  $$
        F_X(x)=F(x, \infty)=\sum_{x_i \leqslant x} \sum_{j=1}^{\infty} p_{i j}
    $$

    \begin{itemize}
        \item $X$的分布律: $P\left\{X=x_i\right\}=\sum_{j=1}^{\infty} p_{i j}, \quad i=1,2, \cdots .$
        \item $Y$的分布律: $P\left\{Y=y_j\right\}=\sum_{i=1}^{\infty} p_{i j}, \quad j=1,2, \cdots .$
    \end{itemize}

    为了方便, 可以引入如下的记号
    $$
        \begin{aligned}
             & p_{i \red{\bullet}}:=\sum_{j=1}^{\infty} p_{i j}=P\left\{X=x_i\right\}, \quad i=1,2, \cdots,   \\
             & p_{{\red{\bullet}} j}:=\sum_{i=1}^{\infty} p_{i j}=P\left\{Y=y_j\right\}, \quad j=1,2, \cdots,
        \end{aligned}
    $$
    分别称 $p_{i \bullet} (i=1,2, \cdots)$ 和 $p_{\bullet j}(j=1,2, \cdots)$ 为 $(X, Y)$ 关于 $X$ 和关于 $Y$ 的\emph{边缘分布律}.
\end{definition*}
    
    其中, 下标中的$\red \bullet$类似通配符: $p_{i\bullet}$ 是由 $p_{i j}$ 关于 $j$ 求和后得到的, 反之亦然. 这样的记号将有助于理解连续的情形.

    \subsection{连续情形}

    \begin{definition*}
      对于连续型随机变量 $(X, Y)$, 设它的概率密度为 $f(x, y)$, 由于
        $$
            F_X(x)=F(x, \infty)=\int_{-\infty}^x\left[\int_{-\infty}^{\infty} f(u, v) \mathrm{d} v\right] \mathrm{d} u
        $$

        \begin{itemize}
            \item $X$是一个连续型的随机变量, 其概率密度为$f_X(x)=\int_{-\infty}^{\infty} f(x, v) \mathrm{d} v$.
            \item $Y$是一个连续型的随机变量, 其概率密度为$f_Y(y)=\int_{-\infty}^{\infty} f(u, y) \mathrm{d} u$.
        \end{itemize}

        分别称 $f_X(x), f_Y(y)$ 为 $(X, Y)$ 关于 $X$ 和关于 $Y$ 的\emph{边缘概率密度.}
    \end{definition*}

    \begin{example}
      设随机变量 $X$ 和 $Y$ 具有联合概率密度
            $$
                f(x, y)= \begin{cases}6, & x^2 \leqslant y \leqslant x, \\ 0, & \text { 其他. }\end{cases}
            $$
            求边缘概率密度 $f_X(x), f_Y(y)$.
    \end{example}

    \begin{solution}根据定义:
      $$\begin{aligned}
              f_X(x) & =\int_{-\infty}^{\infty} f(u, v) \mathrm{d} v= \begin{cases}\int_{x^2}^x 6 \mathrm{~d} v=6\left(x-x^2\right), 0 \leqslant & x \leqslant 1, \\
           0,                                                            & \text { 其他. }\end{cases}               \\
              f_Y(y) & =\int_{-\infty}^{\infty} f(u, v) \mathrm{d} u = \begin{cases}\int_y^{\sqrt{y}} 6 \mathrm{~d} u=6(\sqrt{y}-y), & 0 \leqslant y \leqslant 1, \\
           0,                                               & \text { 其他. }\end{cases}
          \end{aligned}
      $$
  \end{solution}

  最后一个问题是有边缘分布, 能推出联合分布吗? 事实上是不行的. 我们用正态分布做一个例子: 

  \begin{example}
    设二维随机变量 $(X, Y)$ 的概率密度为
    $$
        \begin{aligned}
            f(x, y)= &
            \frac{1}{2 \pi \sigma_1 \sigma_2 \sqrt{1-\rho^2}}
            \exp \left\{
            \frac { - 1 } { 2 ( 1 - \rho ^ { 2 } ) }
            \left[{\color{red}\frac{\left(x-\mu_1\right)^2}{\sigma_1^2}}\right.\right. \\
                     & \left.\left.-2 \rho
            \frac{\left({\color{red}x-\mu_1}\right)\left({\color{teal}y-\mu_2}\right)}{{\color{red}\sigma_1} {\color{teal}\sigma_2}}
            +{\color{teal}\frac{\left(y-\mu_2\right)^2}{\sigma_2^2}}\right]\right\},
        \end{aligned}
    $$
    其中 $\mu_1, \mu_2, \sigma_1, \sigma_2, \rho$ 都是常数, 且 $\sigma_1>0, \sigma_2>0,-1<\rho<1$. 我们称 $(X, Y)$ 为服从参数为 $\mu_1, \mu_2, \sigma_1, \sigma_2, \rho$ 的二维正态分布 (这五个参数的意义将在下一章说明), 记为 $(X, Y) \sim N\left(\mu_1, \mu_2, \sigma_1^2, \sigma_2^2, \rho\right)$. 试求二维正态随机变量的边缘概率密度.
\end{example}

\begin{solution}
  要计算$f_X(x)=\int_{-\infty}^{\infty} f(x, y) \mathrm{d} y$, 由于
            $$\frac{\left(y-\mu_2\right)^2}{\sigma_2^2}-2 \rho \frac{\left(x-\mu_1\right)\left(y-\mu_2\right)}{\sigma_1 \sigma_2}=\left(\frac{y-\mu_2}{\sigma_2}-\rho \frac{x-\mu_1}{\sigma_1}\right)^2-\rho^2 \frac{\left(x-\mu_1\right)^2}{\sigma_1^2}$$,

            于是$$f_X(x)=\frac{1}{2 \pi \sigma_1 \sigma_2 {\color{red}\sqrt{1-\rho^2}}} \mathrm{e}^{-\frac{\left(x-\mu_1\right)^2}{2 \sigma_1^2}} \int_{-\infty}^{\infty} \mathrm{e}^{-\frac{1}{2\left(1-\rho^2\right)}\left({\color{red}\frac{y-\mu_2}{\sigma_2}-\rho \frac{x-\mu_1}{\sigma_1}}\right)^2} \mathrm{~d} y$$
        令 $$t:=\frac{1}{\sqrt{1-\rho^2}}\left(\frac{y-\mu_2}{\sigma_2}-\rho \frac{x-\mu_1}{\sigma_1}\right)$$

        则有$$f_X(x)=\frac{1}{2 \pi \sigma_1} \mathrm{e}^{-\frac{\left(x-\mu_1\right)^2}{2 \sigma_1^2}} \int_{-\infty}^{\infty} \mathrm{e}^{-t^2 / 2} \mathrm{~d} t$$
        即 $$f_X(x)=\frac{1}{\sqrt{2 \pi} \sigma_1} \mathrm{e}^{-\frac{\left(x-\mu_1\right)^2}{2 \sigma_1^2}}, \quad-\infty<x<\infty,$$
        同理有
        \small $$f_Y(y)=\frac{1}{\sqrt{2 \pi} \sigma_2} \mathrm{e}^{-\frac{\left(y-\mu_2\right)^2}{2 \sigma_2^2}}, \quad-\infty<y<\infty.$$

        我们发现二维正态分布的两个边缘分布都是一维正态分布, 而且并不依赖$\rho$. 
        因此, 边缘分布一般不能决定联合分布. 
\end{solution}

\subsection{推广到$n$维}

当然, 高维空间里面的边缘分布也是通过``选择性忽略''有些值定义的. 

\begin{definition}
  设$(X_1,X_2,\dots,X_n)$的分布函数$F(x_1,x_2,\dots,x_n)$为已知, 则$(X_1,X_2,\dots,X_n)$的$k(1 \leq k < n )$维边缘分布函数就随之确定, 例如$(X_1,X_2,\dots,X_n)$关于$X_1$、关于$(X_1,X_2)$的边缘分布函数分别为
    \[F_{X_1}(x_1) = F(x_1,\infty,\infty,\dots,\infty)\],
    \[F_{X_1,X_2}(x_1,x_2) = F(x_1,x_2,\infty,\infty,\dots,\infty)\].
又若$f(x_1,x_2,\dots,x_n)$是$(X_1,X_2,\dots,X_n)$的概率密度, 则$(X_1,X_2,\dots,X_n)$关于$X_1$、关于$(X_1,X_2)$的边缘概率密度分别为
    \[f_{X_1}(x_1) = \int_{-\infty}^{\infty}\int_{-\infty}^{\infty}
    \dots \int_{-\infty}^{\infty}f(x_1,x_2,\dots,x_n)d{x_2}d{x_3}\dots d{x_n}\].
\end{definition}