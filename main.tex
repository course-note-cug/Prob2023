% !TEX root = main.tex
\input{include.tex}
\usepackage{ctex}
% \usepackage[utf8]{inputenc}

\begin{document}

% \input{titlepage.tex}

\input{text/ch1/intro.tex}


\section{事件的概率}

事件的\textbf{概率}：刻画试验中随机事件发生的\textbf{可能性大小}. 

\subsection{概率的统计定义}
\begin{definition}
    设在$n$次试验中，事件$A$发生了$m$次，则称
    \begin{align*}
        f_n(A):=\frac{m}{n}
    \end{align*}
    为事件$A$发生的\textbf{频率}(frequency). 
\end{definition}

\begin{definition*}%[概率的统计定义]
    在相同条件下重复进行的试验中，若随着试验次数$n$的增加，
    事件$A$发生的频率稳定在某一常数$p$附近，
    则称$p$为事件$A$的\textbf{概率}，记作$P(A)=p$. 
\end{definition*}
也就是概率是频率的稳定值. 实际应用中常将大量重复试验中事件的频率作为概率的近似估计. 

\begin{proposition*}
    频率的性质: 
    \begin{itemize}
        \item $0\le f_n(A)\le 1$; 
        \item $f_n(\Omega)=1,\ f_n(\emptyset)=0$; 
        \item 若事件$A_1, A_2, \cdots, A_k$两两互斥，则
              $$f_n \left( \bigcup_{i=1}^k A_i \right)=\sum_{i=1}^k f_n(A_i)$$
    \end{itemize}
\end{proposition*}

由于上述的性质, 我们给出概率的数学公理化定义: 
\begin{definition}[概率的公理化定义]
    设$\Omega$是样本空间，定义概率空间$(\Omega,\mathcal{F},P)$。对每个事件$A\in \mathcal{F}$定义一个实数$P(A)$与之对应。
    集合函数$P$满足以下条件：
    \begin{itemize}
        \item 非负性：对任意事件$A$，均有$P(A)\ge 0$; 
        \item 规范性：$P(\Omega)=1$; 
        \item 可加性：若事件序列$\{A_n\}_{n\ge 1}$两两互斥，则
              $$P \left( \bigcup_{n=1}^{\infty} A_n \right)=\sum_{n=1}^{\infty} P(A_n)$$
    \end{itemize}
    则称$P(A)$为事件$A$的\textbf{概率}(probability). 
\end{definition}

\subsection{概率的加法公式}
\begin{proposition}[加法公式]
    若两个事件$A,B$互斥，则
    $$P(A\cup B)=P(A)+P(B).$$
\end{proposition}

\begin{remark}
    由加法公式可得到如下性质：
    \begin{itemize}
        \item 对任意事件$A$，有
              $P(A)=1-P\left(\overline{A}\right).$
        \item 对任意两个事件$A,B$，有
              $$P(A\cup B)=P(A)+P(B)-P(AB).$$
    \end{itemize}
\end{remark}

\begin{asidebox}
    我们实际上可以借此瞥见容斥原理. 
\begin{remark}
    若三个事件$A_1, A_2, A_3$两两互斥，则
    $$\pmb P(A_1 \cup A_2 \cup A_3) = P(A_1)+P(A_2)+P(A_3).$$
    对任意三个事件$A_1, A_2, A_3$，有
    \begin{align*}
        \pmb P(A_1 \cup A_2 \cup A_3) & \pmb=\color{blue}P(A_1)+P(A_2)+P(A_3)              \\
                                      & \phantom=\color{red}-P(A_1A_2)-P(A_1A_3)-P(A_2A_3) \\
                                      & \phantom=\color{blue}+P(A_1A_2A_3).
    \end{align*}%
\end{remark}

\begin{remark}
    更一般地, 可以使用容斥原理计算: 
    若$n$个事件$A_1, A_2, \cdots, A_n$两两互斥，则
    $$\pmb P\left( \bigcup_{i=1}^n A_i \right)=\sum_{i=1}^n P(A_i).$$
    \vspace{0.2in}
    对任意$n$个事件$A_1, A_2, \cdots, A_n$，有
    $$\pmb P\left( \bigcup_{i=1}^n A_i \right)=\sum_{k=1}^n \left[ (-1)^{k+1} \sum_{1\le i_1\le \cdots\le i_k \le n} P(A_{i_1}\cdots A_{i_k}) \right].$$
\end{remark}


\end{asidebox}

\subsection{古典概型模型}
\begin{definition}
    如果一个随机试验具有以下特点：
    \begin{itemize}%\setcounter{enumi}{2}
        \item 样本空间只含有限多个样本点；
        \item 各样本点出现的可能性相等，
    \end{itemize}
    则称此随机试验是古典型的．此时对每个事件$A\subset \Omega$，
    \begin{align*}
        P(A)=\frac{\mbox{事件$A$包含的样本点数}}{\mbox{样本点的总数}}=\frac{n(A)}{n(\Omega)}
    \end{align*}
    称为事件$A$的\textbf{古典概率}．
\end{definition}

根据上述的定义, 我们可以立即得出$P(\emptyset)=0$，$P(\Omega)=1$．

\subsection*{一点计数技巧}
古典概型的计数有时候会变得更有效率, 下面举例几个计数问题. 

我们来看著名的``The Twelvefold Way''这个问题: 
  它包括了12种从有$n$个球放入有$k$个盒子里的方法. 每种方法具有独特的限制, 
  包括球和盒子是否是区分的及是否允许空盒子等. 
  {\center \begin{tabular}[pos]{|c|c|ccc|}
    \hline
    \text{$n$个球} & \text{$k$个盒子} & 想怎么放怎么放 & 每个盒子最多1个球 & 不允许有空盒子   \\
    \hline
    不同的球$\texttt{oO}o$ & 不同的盒子$\fbox{1}~\fbox{2}~\fbox{3}$ & (1) & (2) & (3)\\
    相同的球$\texttt{ooo}$ & 不同的盒子$\fbox{1}~\fbox{2}~\fbox{3}$ & (4) & (5) & (6)\\
    不同的球$\texttt{oO}o$ & 相同的盒子$\fbox{~}~\fbox{~}~\fbox{~}$ & (7) & (8) & (9)\\
    相同的球$\texttt{ooo}$ & 相同的盒子$\fbox{~}~\fbox{~}~\fbox{~}$ & (10) & (11) & (12)\\
    \hline
  \end{tabular}\\}

  我们下面来看这个问题. 

\textbf{问题(1): $n$个球, $k$个盒子, 盒子和球都是不同的, 随便放} 我们希望做的事情是``把 $n$个球放入$k$个盒子''.
这时候, 我们对于第一个球的选择就随便选一个就好了. 因此有$k$种方法. 对于第二个球, 因为没有限制, 我们照样可以
用$k$种方法...  一直到第$n$个球. 因此总共的方案是$k^n$.

\textbf{问题(2): $n$个球, $k$个盒子, 盒子和球都是不同的, 每个盒子最多1个球} 我们假设盒子的个数多于球, 这样
做的事情就会有意义一点. 
我们希望做的事情是``把 $n$个球放入$k$个盒子, 每个盒子最多1个球''.
这时候, 我们对于第一个球的选择就随便选一个就好了. 因此有$k$种方法. 对于第二个球, 因为没有限制, 我们可以
用$k-1$种方法(有一个已经占用了)...  一直到第$n$个球, 就有$k-n+1$个. 因此总共的方案是$k(k-1)(k-2)\cdots(k-n+1)$.

我们一般把这个叫做排列数, 因为它阐述的是从$k$个物品里面选择$n$个数的方法.\footnote{注意这里的字母顺序可能和一般的教科书
不同. 一般的教科书习惯写作$A_n^k=n(n-1)\cdots(n-k+1)$. 这里的形式对于内容是没有影响的. 二者阐述的是
同一件事情. } 
同时, 从$k$开始, 往下乘$n$个数也被称作下降幂(falling power). 

\begin{definition}[排列数]
  从$n$个物品里面选择$k$个数的方法数记作排列数. 记作$A_n^k$. 计算方法为
  $$
  A_k^n = k(k-1)(k-2)\cdots(k-n+1)
  $$
  其中$k(k-1)(k-2)\cdots(k-n+1)$可以被记作下降幂, 写作$k^{\underline n}$. 
\end{definition}

\textbf{问题(3): $n$个球, $k$个盒子, 盒子和球都是不同的, 不允许有空盒子} 我们发现当我们的球
的数量不少于盒子数量的时候这个内容才有意义. 

既然我不允许有空盒子, 我先随便挑出来$k$个球去``压箱底'', 然后剩下的像刚刚一样
随便放不就好了? 其实这个方法是不对的. 因为这样会算重复一些方案 -- 你默认的要压箱底的和
后来放的在这里是考虑次序的, 而原来的问题是不考虑次序的. 那我们该怎么做? 

这事实上是集合的一个划分. 每一个划分正好对应一个集合. 我们如果能够把这个集合划分为$k$份, 
然后再把每一个划分对应上一个盒子就好了. 第二步很简单, 直接乘上$k!$即可. 

关键是如何划分这个集合? 为了方便我们的符号书写, 我们先记$\left\{{n \atop k}\right\}$ 为把
$n$个集合划分为$k$个部分的个数. 这时候, 我们与其一口吃个胖子, 我们可以一步一步地考虑\footnote{这就有点
递归的意思了! 至此, 你应该能感受到为什么我们把递归问题放在第一节了. }

要把$\{1,2,\ldots,n\}$划分为$k$份, 可以借助那些以往的状态可以把我们带到$\stirling n k$. 

第一种情况是, 我们已经把集合$\{1,2,\ldots,{n-1}\}$分为了$k$个部分, 现在的任务是把$n$放入任何
这$k$部分的其中之一. 这就给了我们$k\left\{{n-1 \atop k}\right\}$种方法达到这个目的. 

第二种情况是, 我们已经把$\{1,2,\ldots,{n-1}\}$分为了$k-1$个部分, 并且让$\{n\}$单独一份. 
这样, 我们就有$\left\{{n-1 \atop k-1}\right\}$种方法. 

这两种方法构建的分割是不同的: 因为在第一种方法中, $n$始终位于一个大小$>1$的划分部分中, 
而在第二种方法中, $\{n\}$始终是一个单独的一部分. 因此这两种情况是不重叠的. 
而对于任意一个$n$元素集合分割为$k$份, 必定可以通过这两种方法之一来构建. 因此根据求和法则: 
$$
\left\{{n \atop k}\right\}=k\left\{{n-1 \atop k}\right\}+\left\{{n-1 \atop k-1}\right\}
$$
成立. 

要求得这个递归式的表达式是十分难的. 我们一般到此为止了. 事实上, 这个内容叫做{\textbf{第二类Stirling数(Stirling number of the second kind)}}. 
要计算第二类Stirling数, 我们有如下的公式: 

\begin{definition}[第二类Stirling数]
  将一个大小为$n$的集合划分为$k$个部分的方案数被命名为第二类Stirling数. 记作$\stirling n k$. 
\end{definition}

\begin{theorem}
  第二类Stirling数满足关系
  $$
  \left\{{n \atop k}\right\}=k\left\{{n-1 \atop k}\right\}+\left\{{n-1 \atop k-1}\right\}
  $$
\end{theorem}

于是, 我们一般使用递推计算的方式计算这个集合. 这个确实需要很多思考, 这就是为什么我们会用一个
伟大数学家的名字命名它. 

这下子, 我们就得到了第三个问题的答案: $k! \stirling n k$. 

\textbf{问题(5): $n$个相同的球, $k$个不同的盒子, 每个盒子顶多1个球} 这就要求我们搞清楚到底哪个
可以有球, 哪个盒子里面没有球就行了. 所以我们要求从$k$个里面选取$n$个出来. 这个应该如何计算呢? 
实际上, 我们可以先从排列数出发, 然后想一想把它们分成若干个组, 也就是从小到大排个序. 这样子就是
总共的组合数有$A_k^n/k!$个. 为了方便起见, 我们把这个定义做组合数. 

\begin{definition}[组合数]
  从$n$个物品里面选取$k$个数的方案数为组合数, 记作${n\choose k}$, 或者$C_n^k$. 定义为
  $$
  {n\choose k}={n(n-1)(n-2)\cdots(n-k+1)\over k!}
  $$
\end{definition}


\textbf{问题(4): $n$个相同的球, $k$个不同的盒子, 随便放} 由于每一个球是相同的, 所以我们需要关注每一个盒子里面
被放了多少球. 因此, 我们就相当于要在这几个球的空档里面``插板''. 由于随意放置, 我们相当于要在$n+k-1$个
里面选出$k$个, 于是, 得到了
$$
{n+k-1\choose k} = \frac{(n+k-1)!}{k!(n-1)!} = {n(n+1)(n+2)\cdots(n+k-1)\over k!}.
$$

我们把这个记作多重组合数的系数(非标准官方译名): 

\begin{definition}[多重集合组合数]
  多重集合的组合数定义为
  $$
  \left(\binom nk\right)=\binom{n+k-1}k=\frac{(n+k-1)!}{k!\left(n-1\right)!}=\frac{n(n+1)(n+2)\cdots(n+k-1)}{k!}.
  $$
  其中, $n(n+1)(n+2)\cdots(n+k-1)$这样的从$n$开始, 向上乘$k$个数这样的被称为上升幂. 方便起见记作
  $n^{\bar k}$
\end{definition}
于是, 我们得到了这个问题的答案: $\binomt kn$. 

\textbf{问题(6): $n$个相同的球, $k$个不同的盒子, 每个盒子不许空} 那么我们不妨首先把前几个球放到前几个球里面, 
然后剩下的就得到了不受限制的状况了. 也就是我们这个的答案是${n-1\choose k-1}. $

\textbf{问题(7): $n$个不同的球, $k$个相同的盒子, 随便放} 我们可以把$\{1,2,\cdots,n\}$划分进$i$个非空的盒子, 
其中, $i\leq k$. 于是根据加法原理, 这个问题的答案是$\sum_{i=1}^{k}\stirling n i$. 

\textbf{问题(8): $n$个不同的球, $k$个相同的盒子, 每个盒子顶多一个球} 事实上, 如果$n>k$, 那么不可能做到.
根据抽屉原理, 总有一个盒子要装两个球. 反之, 我们就可以做到. 于是这个问题的答案是$$\begin{cases}1 & \text{if }n\leq k\\ 0& \text{if }n>k\end{cases}.$$

\textbf{问题(9): $n$个不同的球, $k$个相同的盒子, 不允许有空的盒子} 哈哈! 这不就是我们集合划分的定义吗? 
这样, 我们就可以用$\stirling n k$表示了.

\textbf{问题(12): $n$个球, $k$个盒子, 盒子和球都相同, 不能有空盒子} 其实这个是
当我们把球放进盒子里面之后, 真正重要的
是什么? 事实上, 我们发现我们只要关心每个盒子有几个球就好了, 并且我们不用关心有多少球的顺序. 
等价地说, 就是把一个整数分拆. 比如7就可以这样分拆成1, 2, $\cdots,$ 7部分:

$$
\begin{aligned}
&\{7\}
& p_1(7)=1\\
&\{1,6\},\{2,5\},\{3,4\}
& p_2(7)=3\\
&\{1,1,5\}, \{1,2,4\}, \{1,3,3\}, \{2,2,3\} 
& p_3(7)=4\\
&\{1,1,1,4\},\{1,1,2,3\}, \{1,2,2,2\}
& p_4(7)=3\\
&\{1,1,1,1,3\},\{1,1,1,2,2\}
& p_5(7)=2\\
&\{1,1,1,1,1,2\}
& p_6(7)=1\\
&\{1,1,1,1,1,1,1\}
& p_7(7)=1
\end{aligned}
$$

等价地说, 我们的要求是一个数$n$的$k$分拆, 分别记作$x_1, x_2, \cdots, x_k$, 满足如下的条件(*): 
\begin{itemize}[noitemsep]
  \item  $x_1\ge x_2\ge\cdots\ge x_k\ge 1$;
  \item $x_1+x_2+\cdots+x_k=n$.
\end{itemize}

为了方便起见, 我们把整数$n$分拆成$k$部分记作$p_k(n)$. 读作``$n$的$k$-分割''下面我们同样用类似于递归的方法
来求解这个问题: 

假设 \((x_1,\ldots,x_k)\) 是 \(n\) 的一个 \(k\)-分割. 满足刚刚我们提到过的条件(*).

我们对这个问题分类讨论: 第一种情况是, 如果 \(x_k = 1\),
那么 \((x_1,\cdots,x_{k-1})\) 是 把\(n-1\) 分割成的一个不同的 \((k-1)\)-分割

第二种情况是, 如果 \(x_k > 1\), 那么 \((x_1-1,\cdots,x_{k}-1)\) 是 \(n-k\) 
的一个不同的 \(k\)-分割. 并且每个 \(n-k\) 的 \(k\)-分割都可以通过这种方式得到. 
因此在这种情况下, \(n\) 的 \(k\)-分割数目为 \(p_k(n-k)\). 

由于所有的情况都已经讨论完毕, 因此, 我们可以使用加法原理, 把这两个部分加起来, 得到了
\(n\) 的 \(k\)-分割数目为 \(p_{k-1}(n-1) + p_k(n-k)\), 即

\[p_k(n)=p_{k-1}(n-1)+p_k(n-k)\,.\]

\begin{definition}[分拆数]
  定义分拆数$p_k(n)$表示把一个正整数$n$分拆为$k$部分, 分别记作$x_1, x_2, \cdots, x_k$, 满足如下的条件
  的个数: 
  \begin{itemize}[noitemsep]
    \item  $x_1\ge x_2\ge\cdots\ge x_k\ge 1$;
    \item $x_1+x_2+\cdots+x_k=n$.
  \end{itemize}
\end{definition}

\begin{theorem}
  分拆数满足性质
  $$p_k(n)=p_{k-1}(n-1)+p_k(n-k)\,.$$
\end{theorem}

所以我们这个问题的答案就是$p_n(k)$. 

\textbf{问题(10): $n$个球, $k$个盒子, 盒子和球都相同, 随便放} 
有了分拆数之后, 我们就可以决定到底要分拆多少个了,  于是答案就是$\sum_{i=1}^{k}p_i(n)$. 

\textbf{问题(11): $n$个球, $k$个盒子, 盒子和球都相同, 每个盒子顶多1个球} 它和第(8)问的情况类似. 同样要么
能做, 要么不能做. 原理还是依照第八个问题一样. 

这样我们就得到了整个表格的全貌: 

{\center \begin{tabular}[pos]{|c|c|ccc|}
  \hline
  \text{$n$个球} & \text{$k$个盒子} & 想怎么放怎么放 & 每个盒子最多1个球 & 不允许有空盒子   \\
  \hline
  不同的球$\texttt{oO}o$ & 不同的盒子$\fbox{1}~\fbox{2}~\fbox{3}$ & $k^n$ & $k^{\underline n}$ & $n!\stirling nk$\\
  相同的球$\texttt{ooo}$ & 不同的盒子$\fbox{1}~\fbox{2}~\fbox{3}$ & $\binomt kn$ & ${k\choose n}$ & $\binomt{k}{n-k}$\\
  不同的球$\texttt{oO}o$ & 相同的盒子$\fbox{~}~\fbox{~}~\fbox{~}$ & $\sum_{i=1}^k \stirling ni$ & $\begin{cases}1 & \text{if }n\leq k\\ 0& \text{if }n>k\end{cases}$ & $\stirling n k$\\
  相同的球$\texttt{ooo}$ & 相同的盒子$\fbox{~}~\fbox{~}~\fbox{~}$ & $\sum_{i=1}^k p_i(n)$ & $\begin{cases}1 & \text{if }n\leq k\\ 0& \text{if }n>k\end{cases}$ & $p_k(n)$\\
  \hline
\end{tabular}\\}

不要担心这张表格看起来有些复杂. 其实, 这张表格没有记忆的必要. 现在我们只需要学习排列数和组合数就可以建立一个很好的模型了. 
这些概念是非常有趣和实用的, 它们能够帮助我们解决很多有趣的问题. 

上述材料里面的有时候我们还会遇到更加复杂的问题, 比如对于分拆数, 我们需要将一个数分拆成若干个部分, 并且考虑它们之间的顺序. 
都可以通过一些递归的方法来解决. 我们只当做对大家的训练. 一个初学者当然需要看过足够多的例子, 加以大量的思考
才能设计出比较好的这方面的内容. 大家完全不必着急. 

假设我们有$n$个不同的球, $k$个不同的盒子. 我们可以用一个映射的方式来描述不同的放置方法. 
具体来说, 我们可以把每个盒子看作一个“投影”, 而每个球就是我们要放入的“元素”. 
这样, 每一种放置方法就可以看作是一个特定的映射. 

那么, 任意的映射就是我们刚刚的``随便放''; 单射就是我们的``每个盒子只放一个球''; 满射就是``每个盒子不能空''. 
因此, 这个表格更为一般的情况你就能够看得懂了. 

{\center \begin{tabular}[pos]{|c|c|ccc|}
  \hline
  $N$ & $M$ & 任何一个$f:N\to M$ & 单射$f:N\stackrel{\to}{\text{\tiny 1-1}} M$ & 满射$f:N\stackrel{\to}{\text{\tiny onto}} M$   \\
  \hline
  不同的球$\texttt{oO}o$ & 不同的盒子$\fbox{1}~\fbox{2}~\fbox{3}$ & $k^n$ & $k^{\underline n}$ & $n!\stirling nk$\\
  相同的球$\texttt{ooo}$ & 不同的盒子$\fbox{1}~\fbox{2}~\fbox{3}$ & $\binomt kn$ & ${k\choose n}$ & $\binomt{k}{n-k}$\\
  不同的球$\texttt{oO}o$ & 相同的盒子$\fbox{~}~\fbox{~}~\fbox{~}$ & $\sum_{i=1}^k \stirling ni$ & $\begin{cases}1 & \text{if }n\leq k\\ 0& \text{if }n>k\end{cases}$ & $\stirling n k$\\
  相同的球$\texttt{ooo}$ & 相同的盒子$\fbox{~}~\fbox{~}~\fbox{~}$ & $\sum_{i=1}^k p_i(n)$ & $\begin{cases}1 & \text{if }n\leq k\\ 0& \text{if }n>k\end{cases}$ & $p_k(n)$\\
  \hline
\end{tabular}\\}

\subsection{几何概型}

\begin{definition}
    设样本空间为有限区域$\Omega$,若样本点落入$\Omega$内的任何区域$G$中的概率与区域$G$的测度成正比，则样本点落入$G$内的概率为：
    $$
        p=\frac{\vert G\vert}{\vert \Omega \vert}
    $$
\end{definition}

并且我们发现, $P(A)=0$, 则$A$不一定是不可能事件. 



\end{document}
